include @top_srcdir@/Makefile.inc

ifeq "@MINGW@" "yes"
	IMPLIB=@MAKELIBDIR@XTreeShr.dll.a
	MAKE_IMPLIB=-Wl,--out-implib,$(IMPLIB)
endif

CPPFLAGS+=@SRBINCLUDE@

SOURCES = \
	XTreeConvertToLongTime.c\
	XTreeDefaultSquish.c \
	XTreeDefaultResample.c \
	XTreeGetTimedRecord.c \
	XTreeGetSegmentList.c

OBJECTS = $(SOURCES:.c=.o)
EXPORTS = XXTreeShr.exports

all : @MAKELIBDIR@ @MAKESHLIBDIR@ @MAKESHLIBDIR@@LIBPRE@XTreeShr@SHARETYPE@ @MAKELIBDIR@@LIBPRE@XTreeShr.a

clean:
	@ $(RM) $(OBJECTS)
	@ $(RM) @MAKESHLIBDIR@@LIBPRE@XTreeShr@SHARETYPE@
	@ $(RM) @MAKELIBDIR@@LIBPRE@XTreeShr.a
ifdef IMPLIB
	@ $(RM) $(IMPLIB)
endif

depend:
	@makedepend -- $(CFLAGS) -- $(SOURCES)

install: $(libdir)
	$(INSTALL) -m 755  @MAKESHLIBDIR@@LIBPRE@XTreeShr@SHARETYPE@ $(libdir)
ifdef IMPLIB
	$(INSTALL) -m 755 $(IMPLIB) $(libdir)
endif
	if test @SHARETYPE@ != .a ; then \
		$(INSTALL) -m 644 @MAKELIBDIR@@LIBPRE@XTreeShr.a $(libdir); \
	fi;

@MAKESHLIBDIR@@LIBPRE@XTreeShr@SHARETYPE@: $(OBJECTS) @EXPORTS_FILE@ 
	$(LINK.o) $(OUTPUT_OPTION) @LINKSHARED@ $(OBJECTS) $(LIBS) -L@MAKESHLIBDIR@ -lTdiShr -lTreeShr -lMdsShr @SRBLIB@

@MAKELIBDIR@@LIBPRE@XTreeShr.a: $(OBJECTS)
	$(AR) -cr $@ $^
	@RANLIB@ $@

XTreeShr.exports: XTreeShr.def
	$(SED) -e /LIBRARY/\;/\;/d $< > $@
